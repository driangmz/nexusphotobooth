<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRO Photo Booth | Studio Edition</title>
    <style>
        :root {
            --primary: #00f2ea;
            --secondary: #ff0050;
            --dark: #0a0a0a;
            --panel-bg: rgba(255, 255, 255, 0.08);
            --text: #ffffff;
            --glass-border: 1px solid rgba(255, 255, 255, 0.15);
            --font-main: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * { box-sizing: border-box; outline: none; }

        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-main);
            background-color: var(--dark);
            color: var(--text);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        /* --- ANIMATIONS --- */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes glow { 0% { text-shadow: 0 0 10px rgba(0, 242, 234, 0.5); } 50% { text-shadow: 0 0 20px rgba(0, 242, 234, 0.8), 0 0 40px rgba(255, 0, 80, 0.6); } 100% { text-shadow: 0 0 10px rgba(0, 242, 234, 0.5); } }
        @keyframes float { 0% { transform: translateY(0px); } 50% { transform: translateY(-10px); } 100% { transform: translateY(0px); } }
        @keyframes flashAnim { 0% { opacity: 1; } 100% { opacity: 0; } }
        @keyframes countAnim { 0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0; } 50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; } 100% { transform: translate(-50%, -50%) scale(1); opacity: 0; } }
        @keyframes popIn { from { opacity: 0; transform: scale(0.8); } to { opacity: 1; transform: scale(1); } }

        /* --- WELCOME SCREEN --- */
        #welcome-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at center, #1a1a1a 0%, #000 100%);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease;
        }

        .welcome-content {
            text-align: center;
            animation: fadeIn 1s ease-out;
            padding: 20px;
        }

        .welcome-title {
            font-size: 4rem;
            font-weight: 900;
            text-transform: uppercase;
            margin-bottom: 10px;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: glow 3s infinite;
        }

        .welcome-subtitle {
            font-size: 1.2rem;
            opacity: 0.8;
            margin-bottom: 40px;
            letter-spacing: 2px;
        }

        .start-btn {
            padding: 18px 50px;
            font-size: 1.2rem;
            background: white;
            color: black;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 0 20px rgba(255,255,255,0.3);
            text-transform: uppercase;
            letter-spacing: 1px;
            animation: float 3s ease-in-out infinite;
        }

        .start-btn:hover { transform: scale(1.05); box-shadow: 0 0 40px rgba(255,255,255,0.5); }
        .start-btn:active { transform: scale(0.95); }

        .privacy-link {
            margin-top: 30px;
            color: rgba(255,255,255,0.5);
            text-decoration: underline;
            cursor: pointer;
            font-size: 0.9rem;
            transition: color 0.2s;
        }
        .privacy-link:hover { color: var(--primary); }

        /* --- PRIVACY MODAL --- */
        #privacy-modal {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(5px);
            z-index: 200;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: #151515;
            border: var(--glass-border);
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            text-align: left;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            animation: popIn 0.3s ease;
        }

        .modal-content h2 { margin-top: 0; color: var(--primary); }
        .modal-content p { line-height: 1.6; opacity: 0.8; }
        .close-modal {
            background: #333;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            margin-top: 20px;
            cursor: pointer;
            float: right;
        }
        .close-modal:hover { background: #444; }

        /* --- MAIN APP (Hidden initially) --- */
        #app-container {
            display: none;
            width: 100%;
            flex-direction: column;
            align-items: center;
            opacity: 0;
            transition: opacity 1s ease;
        }

        /* --- HEADER --- */
        header {
            width: 100%;
            padding: 15px 20px;
            text-align: center;
            background: linear-gradient(90deg, #111, #000);
            border-bottom: var(--glass-border);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-logo {
            margin: 0;
            font-weight: 800;
            font-size: 1.5rem;
            text-transform: uppercase;
            background: linear-gradient(to right, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-controls button { font-size: 0.8rem; padding: 6px 12px; border: 1px solid rgba(255,255,255,0.2); }

        .main-stage {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            gap: 20px;
            padding: 0 15px;
        }

        /* --- VIEWFINDER --- */
        .booth-container {
            position: relative;
            background: #000;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            overflow: hidden;
            border: var(--glass-border);
            transition: all 0.3s ease;
        }

        .ratio-landscape { width: 100%; max-width: 800px; aspect-ratio: 16/9; }
        .ratio-portrait  { width: 100%; max-width: 450px; aspect-ratio: 3/4; }
        .ratio-square    { width: 100%; max-width: 600px; aspect-ratio: 1/1; }

        video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transform: scaleX(-1);
            display: block;
        }

        /* --- OVERLAYS --- */
        .overlay-countdown {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            font-size: 8rem;
            font-weight: 900;
            color: white;
            text-shadow: 0 0 30px rgba(0,0,0,0.8);
            opacity: 0;
            pointer-events: none;
            z-index: 10;
        }

        .flash-overlay {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            opacity: 0;
            pointer-events: none;
            z-index: 20;
        }

        /* --- CONTROLS UI --- */
        .controls-panel {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            padding: 20px;
            background: var(--panel-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 16px;
            border: var(--glass-border);
            width: 100%;
            max-width: 900px;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center;
        }

        .control-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.6;
        }

        .btn-group {
            display: flex;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            padding: 4px;
            flex-wrap: wrap;
            justify-content: center;
        }

        button {
            background: transparent;
            border: none;
            color: white;
            padding: 8px 16px;
            cursor: pointer;
            border-radius: 6px;
            font-size: 0.9rem;
            transition: all 0.2s;
            font-weight: 500;
        }

        button:hover { background: rgba(255,255,255,0.1); }
        button.active { background: var(--primary); color: #000; font-weight: bold; box-shadow: 0 0 10px rgba(0, 242, 234, 0.3); }

        /* Shutter Button */
        .shutter-btn {
            background: var(--secondary) !important;
            color: white !important;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            border: 4px solid rgba(255,255,255,0.2) !important;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 20px rgba(255, 0, 80, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .shutter-btn:hover { transform: scale(1.1); box-shadow: 0 0 30px rgba(255, 0, 80, 0.6); }
        .shutter-btn:active { transform: scale(0.95); }
        .shutter-icon { width: 24px; height: 24px; background: white; border-radius: 50%; }

        /* --- GALLERY --- */
        .gallery-section {
            width: 100%;
            max-width: 1000px;
            margin-top: 40px;
            padding: 20px;
        }

        .gallery-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            padding-bottom: 10px;
        }

        .gallery-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .photo-card {
            background: #1a1a1a;
            border-radius: 12px;
            overflow: hidden;
            position: relative;
            box-shadow: 0 4px 10px rgba(0,0,0,0.3);
            border: 1px solid #333;
            transition: transform 0.2s;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .photo-card:hover { transform: translateY(-5px); }
        .photo-card img { width: 100%; height: auto; display: block; }

        .card-actions {
            display: flex;
            justify-content: space-between;
            padding: 10px;
            background: #222;
        }

        .action-btn { font-size: 0.8rem; padding: 6px 12px; border-radius: 4px; text-decoration: none; }
        .btn-download { background: #333; color: var(--primary); display: inline-block; }
        .btn-download:hover { background: #444; }
        .btn-delete { color: #ff4444; }
        .btn-delete:hover { background: rgba(255, 68, 68, 0.1); }

        canvas { display: none; }

        @media (max-width: 600px) {
            .welcome-title { font-size: 2.5rem; }
            .controls-panel { flex-direction: column; align-items: stretch; }
            .btn-group { justify-content: center; }
            .shutter-btn { align-self: center; margin: 10px 0; }
        }
    </style>
</head>
<body>

    <div id="welcome-screen">
        <div class="welcome-content">
            <div class="welcome-title">STUDIO BOOTH</div>
            <div class="welcome-subtitle">Professional Web-Based Photography</div>
            <button class="start-btn" onclick="enterBooth()">Enter Booth</button>
            <div class="privacy-link" onclick="openPrivacy()">Privacy Policy</div>
        </div>
    </div>

    <div id="privacy-modal">
        <div class="modal-content">
            <h2>Privacy Policy</h2>
            <p><strong>Your privacy is our priority.</strong></p>
            <p>This application operates 100% locally within your web browser. No video feed, images, or personal data are ever sent to a server or the cloud. All processing happens on your device using your computer's resources. Images are stored in your browser's temporary memory and are deleted when you refresh the page or close the tab. We are committed to protecting your privacy and ensuring that your experience remains safe, transparent, and under your control. By using this application, you acknowledge that all data remains confined to your device and that no external party has access to your content. This design ensures that your information is never collected, analyzed, or shared beyond your browser session.  
            <h2></h2>Rights and Terms</h2>
            <p></p>You retain full ownership of all images, videos, and content processed through this application. Nothing you create or upload is stored permanently, nor is it transmitted to any external service. You have the right to close the application at any time, which will immediately clear temporary memory and remove any stored images. We do not claim any rights over your creative output, and you are free to use, share, or delete your content as you see fit.   By proceeding, you agree to use this application responsibly and acknowledge that it is provided “as is,” without warranties of any kind. While we strive to ensure smooth performance, we cannot guarantee uninterrupted service or absolute technical perfection. You accept that the application may occasionally encounter errors or limitations due to the constraints of your device’s hardware and browser environment. You also agree not to misuse the application for unlawful purposes, including but not limited to the creation or distribution of harmful, offensive, or illegal content. The developers disclaim liability for any misuse or damages resulting from your use of the application. Your continued use signifies your acceptance of these terms and your understanding that responsibility for all content rests with you. We reserve the right to update this Privacy Policy and Terms of Use to reflect improvements, legal requirements, or changes in technology. Any updates will be communicated through revisions to this text, and your continued use after such updates will constitute acceptance of the revised terms.  
            <h2></h2>Further and Credits</h2>
            <p></p>This project was built with a commitment to transparency, accessibility, and respect for user privacy. It reflects a philosophy of empowering users to create freely without sacrificing control over their personal data. Created with love. by @ianny  </p>
            <button class="close-modal" onclick="closePrivacy()">I Understand</button>
        </div>
    </div>

    <div id="app-container">
        <header>
            <div class="header-logo">Studio Booth Pro</div>
            <div class="header-controls">
                <button onclick="openPrivacy()">Privacy</button>
            </div>
        </header>

        <div class="main-stage">
            <div id="booth-frame" class="booth-container ratio-landscape">
                <video id="video" autoplay playsinline></video>
                <div id="countdown" class="overlay-countdown">3</div>
                <div id="flash" class="flash-overlay"></div>
            </div>

            <div class="controls-panel">
                
                <div class="control-group">
                    <span class="control-label">Format</span>
                    <div class="btn-group">
                        <button onclick="setRatio('landscape', this)" class="active">16:9</button>
                        <button onclick="setRatio('portrait', this)">3:4</button>
                        <button onclick="setRatio('square', this)">1:1</button>
                    </div>
                </div>

                <div class="control-group">
                    <span class="control-label">Timer</span>
                    <div class="btn-group">
                        <button onclick="setTimer(0, this)">Off</button>
                        <button onclick="setTimer(3, this)" class="active">3s</button>
                        <button onclick="setTimer(5, this)">5s</button>
                    </div>
                </div>

                <div class="control-group">
                    <span class="control-label">Filters</span>
                    <div class="btn-group" style="max-width: 400px;">
                        <button onclick="setFilter('none', this)" class="active">Normal</button>
                        <button onclick="setFilter('grayscale(100%)', this)">B&W</button>
                        <button onclick="setFilter('sepia(100%)', this)">Sepia</button>
                        <button onclick="setFilter('contrast(1.3) saturate(1.5)', this)">Vivid</button>
                        <button onclick="setFilter('contrast(1.2) sepia(0.4)', this)">Vintage</button>
                        <button onclick="setFilter('saturate(2) hue-rotate(200deg)', this)">Cyber</button>
                        <button onclick="setFilter('saturate(1.2) sepia(0.3) contrast(1.1)', this)">Golden</button>
                        <button onclick="setFilter('contrast(1.4) brightness(0.9) grayscale(0.3)', this)">Dramatic</button>
                    </div>
                </div>

                <div class="control-group" style="justify-content: center; width: 100%;">
                    <button id="snap-btn" class="shutter-btn">
                        <div class="shutter-icon"></div>
                    </button>
                </div>

            </div>
        </div>

        <div class="gallery-section">
            <div class="gallery-header">
                <h3>Session Gallery</h3>
                <button onclick="clearGallery()" class="btn-delete" style="background:transparent; border:1px solid #333;">Clear All</button>
            </div>
            <div id="gallery-grid" class="gallery-grid">
                </div>
        </div>
    </div>

    <canvas id="canvas"></canvas>

    <script>
        /**
         * STATE & CONFIGURATION
         */
        const state = {
            filter: 'none',
            timerDuration: 3,
            ratio: 'landscape', 
            isCapturing: false
        };

        const DOM = {
            welcome: document.getElementById('welcome-screen'),
            app: document.getElementById('app-container'),
            privacy: document.getElementById('privacy-modal'),
            video: document.getElementById('video'),
            canvas: document.getElementById('canvas'),
            frame: document.getElementById('booth-frame'),
            countdown: document.getElementById('countdown'),
            flash: document.getElementById('flash'),
            snapBtn: document.getElementById('snap-btn'),
            gallery: document.getElementById('gallery-grid')
        };

        /**
         * UX FLOW
         */
        function openPrivacy() {
            DOM.privacy.style.display = 'flex';
        }

        function closePrivacy() {
            DOM.privacy.style.display = 'none';
        }

        function enterBooth() {
            initCamera().then(() => {
                DOM.welcome.style.opacity = '0';
                setTimeout(() => {
                    DOM.welcome.style.display = 'none';
                    DOM.app.style.display = 'flex';
                    // Trigger reflow for transition
                    DOM.app.offsetHeight; 
                    DOM.app.style.opacity = '1';
                }, 800);
            });
        }

        /**
         * CAMERA INIT
         */
        async function initCamera() {
            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { 
                        width: { ideal: 1920 }, 
                        height: { ideal: 1080 },
                        facingMode: "user" 
                    }, 
                    audio: false 
                });
                DOM.video.srcObject = stream;
                return true;
            } catch (error) {
                console.error("Camera Error:", error);
                alert("Camera Access Denied. Please ensure you are using HTTPS or Localhost and have granted permission.");
                return false;
            }
        }

        /**
         * CONTROLS LOGIC
         */
        function setRatio(type, btn) {
            updateActiveButton(btn);
            state.ratio = type;
            DOM.frame.className = `booth-container ratio-${type}`;
        }

        function setTimer(seconds, btn) {
            updateActiveButton(btn);
            state.timerDuration = seconds;
        }

        function setFilter(filterVal, btn) {
            updateActiveButton(btn);
            state.filter = filterVal;
            DOM.video.style.filter = filterVal;
        }

        function updateActiveButton(clickedBtn) {
            const siblings = clickedBtn.parentElement.children;
            for (let btn of siblings) btn.classList.remove('active');
            clickedBtn.classList.add('active');
        }

        /**
         * CAPTURE LOGIC
         */
        DOM.snapBtn.addEventListener('click', () => {
            if (state.isCapturing) return;
            state.isCapturing = true;

            if (state.timerDuration > 0) {
                runCountdown(state.timerDuration);
            } else {
                takePicture();
            }
        });

        function runCountdown(num) {
            let count = num;
            DOM.countdown.innerText = count;
            DOM.countdown.style.opacity = 1; // Ensure visible
            
            // Reset animation
            DOM.countdown.style.animation = 'none';
            DOM.countdown.offsetHeight; 
            DOM.countdown.style.animation = 'countAnim 1s linear';
            
            const interval = setInterval(() => {
                count--;
                if (count > 0) {
                    DOM.countdown.innerText = count;
                    DOM.countdown.style.animation = 'none';
                    DOM.countdown.offsetHeight; 
                    DOM.countdown.style.animation = 'countAnim 1s linear';
                } else {
                    clearInterval(interval);
                    DOM.countdown.style.opacity = 0;
                    takePicture();
                }
            }, 1000);
        }

        function takePicture() {
            // Flash
            DOM.flash.style.animation = 'none';
            DOM.flash.offsetHeight;
            DOM.flash.style.animation = 'flashAnim 0.3s ease-out';
            
            // Setup Canvas
            const vidW = DOM.video.videoWidth;
            const vidH = DOM.video.videoHeight;
            const ctx = DOM.canvas.getContext('2d');

            // Calculate Crop
            let drawW, drawH, startX, startY;
            const videoRatio = vidW / vidH;
            
            let targetRatio = 16/9;
            if (state.ratio === 'portrait') targetRatio = 3/4;
            if (state.ratio === 'square') targetRatio = 1/1;

            if (videoRatio > targetRatio) {
                drawH = vidH;
                drawW = vidH * targetRatio;
                startX = (vidW - drawW) / 2;
                startY = 0;
            } else {
                drawW = vidW;
                drawH = vidW / targetRatio;
                startX = 0;
                startY = (vidH - drawH) / 2;
            }

            DOM.canvas.width = drawW;
            DOM.canvas.height = drawH;

            // Draw
            ctx.save();
            ctx.translate(drawW, 0);
            ctx.scale(-1, 1);

            if (state.filter !== 'none') {
                ctx.filter = state.filter;
            }
            
            ctx.drawImage(DOM.video, startX, startY, drawW, drawH, 0, 0, drawW, drawH);
            ctx.restore();

            // Save
            const dataURL = DOM.canvas.toDataURL('image/png', 1.0);
            addToGallery(dataURL);
            state.isCapturing = false;
        }

        /**
         * GALLERY LOGIC
         */
        function addToGallery(dataURL) {
            const filename = `studio_booth_${Date.now()}.png`;

            const card = document.createElement('div');
            card.className = 'photo-card';
            card.innerHTML = `
                <img src="${dataURL}" alt="Photo capture">
                <div class="card-actions">
                    <button class="action-btn btn-delete" onclick="deletePhoto(this)">Delete</button>
                    <a href="${dataURL}" download="${filename}" class="action-btn btn-download">Download</a>
                </div>
            `;
            
            DOM.gallery.prepend(card);
        }

        function deletePhoto(btn) {
            if(confirm('Delete this photo?')) {
                const card = btn.closest('.photo-card');
                card.remove();
            }
        }

        function clearGallery() {
            if(confirm('Delete all photos?')) {
                DOM.gallery.innerHTML = '';
            }
        }
    </script>
</body>
</html>

